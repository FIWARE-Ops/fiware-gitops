apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloak-consumer-realm
data:
  dome-realm.json: |-
    {
      "id": "dome",
      "realm": "dome",
      "displayName": "Keycloak",
      "displayNameHtml": "<div class=\"kc-logo-text\"><span>Keycloak</span></div>",
      "enabled": true,
      "attributes": {
        "frontendUrl": "https://keycloak-consumer.dome.fiware.dev/",
        "issuerDid": "did:web:consumer.dome.fiware.dev",
        "keyPath": "/opt/key/tls.key"
      },
      "sslRequired": "none",
      "roles": {
        "realm": [
          {
            "name": "user",
            "description": "User privileges",
            "composite": false,
            "clientRole": false,
            "containerId": "dome",
            "attributes": {}
          }
        ],
        "client": {
          "did:web:onboarding.dome-marketplace.org": [
            {
              "name": "LEGAL_REPRESENTATIVE",
              "description": "Is allowed to register participants",
              "clientRole": true
            },
            {
              "name": "EMPLOYEE",
              "description": "Is allowed to see participants",
              "clientRole": true
            }
          ],
          "did:web:dome-marketplace.org": [
            {
              "name": "consumer",
              "description": "Is allowed to buy.",
              "clientRole": true
            }
          ]
        }
      },
      "groups": [
      ],
      "users": [
      ],
      "clients": [
        {
          "clientId": "did:web:onboarding.dome-marketplace.org",
          "enabled": true,
          "description": "Client to connect the onboarding services of the marketplace",
          "surrogateAuthRequired": false,
          "alwaysDisplayInConsole": false,
          "clientAuthenticatorType": "client-secret",
          "defaultRoles": [],
          "redirectUris": [],
          "webOrigins": [],
          "notBefore": 0,
          "bearerOnly": false,
          "consentRequired": false,
          "standardFlowEnabled": true,
          "implicitFlowEnabled": false,
          "directAccessGrantsEnabled": false,
          "serviceAccountsEnabled": false,
          "publicClient": false,
          "frontchannelLogout": false,
          "protocol": "OIDC4VP",
          "attributes": {
              "client.secret.creation.time": "1675260539",
              "expiryInMin": "3600",
              "vctypes_NaturalPersonCredential": "ldp_vc,jwt_vc_json",
              "vctypes_GaiaXParticipantCredential": "ldp_vc,jwt_vc_json"
          },
          "protocolMappers": [
            { 
              "name": "target-role-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-target-role-mapper",
              "config": {
                   "subjectProperty": "roles",
                   "clientId": "did:web:onboarding.dome-marketplace.org",
                   "supportedCredentialTypes": "NaturalPersonCredential"
              }
            },
            { 
              "name": "email-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                   "subjectProperty": "email",
                   "userAttribute": "email", 
                   "supportedCredentialTypes": "NaturalPersonCredential"
              }
            },
            { 
              "name": "first-name-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                   "subjectProperty": "firstName",
                   "userAttribute": "firstName", 
                   "supportedCredentialTypes": "NaturalPersonCredential"
              }
            },
            { 
              "name": "lastName-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                   "subjectProperty": "familyName",
                   "userAttribute": "lastName", 
                   "supportedCredentialTypes": "NaturalPersonCredential" 
              }
            },
            { 
              "name": "id-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-subject-id-mapper", 
              "config": {
                "supportedCredentialTypes": "NaturalPersonCredential,GaiaXParticipantCredential"
              }
            },
            { 
              "name": "did-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-static-claim-mapper",
              "config": {
                "subjectProperty": "subjectDid",
                "staticValue": "did:web:dome-marketplace.org",
                "supportedCredentialTypes": "GaiaXParticipantCredential"
              }
            },
            { 
              "name": "legal-name-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-static-claim-mapper",
              "config": {
                "subjectProperty": "gx:legalName",
                "staticValue": "dome-marketplace.org",
                "supportedCredentialTypes": "GaiaXParticipantCredential"
              }
            }
          ],
          "authenticationFlowBindingOverrides": {},
          "fullScopeAllowed": true,
          "nodeReRegistrationTimeout": -1,
          "defaultClientScopes": [],
          "optionalClientScopes": []
        },
        {
          "clientId": "did:web:dome-marketplace.org",
          "enabled": true,
          "description": "Client to connect to the marketplace portal.",
          "surrogateAuthRequired": false,
          "alwaysDisplayInConsole": false,
          "clientAuthenticatorType": "client-secret",
          "defaultRoles": [],
          "redirectUris": [],
          "webOrigins": [],
          "notBefore": 0,
          "bearerOnly": false,
          "consentRequired": false,
          "standardFlowEnabled": true,
          "implicitFlowEnabled": false,
          "directAccessGrantsEnabled": false,
          "serviceAccountsEnabled": false,
          "publicClient": false,
          "frontchannelLogout": false,
          "protocol": "OIDC4VP",
          "attributes": {
              "client.secret.creation.time": "1675260539",
              "expiryInMin": "3600",
              "vctypes_NaturalPersonCredential": "ldp_vc,jwt_vc_json"
          },
          "protocolMappers": [
            { 
              "name": "target-role-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-target-role-mapper",
              "config": {
                "subjectProperty": "roles",
                "clientId": "did:web:dome-marketplace.org",
                "supportedCredentialTypes": "NaturalPersonCredential"
              }
            },
            { 
              "name": "email-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                "subjectProperty": "email",
                "userAttribute": "email",
                "supportedCredentialTypes": "NaturalPersonCredential"
              }
            },
            { 
              "name": "first-name-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                "subjectProperty": "firstName",
                "userAttribute": "firstName",
                "supportedCredentialTypes": "NaturalPersonCredential" 
              }
            },
            { 
              "name": "lastName-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-user-attribute-mapper",
              "config": {
                "subjectProperty": "familyName",
                "userAttribute": "lastName",
                "supportedCredentialTypes": "NaturalPersonCredential"  
              }
            },
            { 
              "name": "id-mapper",
              "protocol": "OIDC4VP",
              "protocolMapper": "oidc4vp-subject-id-mapper",
              "config": {
                "supportedCredentialTypes": "NaturalPersonCredential"
              }
            }
          ],
          "authenticationFlowBindingOverrides": {},
          "fullScopeAllowed": true,
          "nodeReRegistrationTimeout": -1,
          "defaultClientScopes": [],
          "optionalClientScopes": []
        }
      ],
      "clientScopes": [
      ],
      "defaultDefaultClientScopes": [
      ],
      "defaultOptionalClientScopes": [
      ]
    }
