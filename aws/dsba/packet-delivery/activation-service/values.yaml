activation-service:
  deployment:
    image:
      repository: quay.io/i4trust/activation-service
      #tag: 2.1.1
      tag: 2.2.0-PRE-18
      #pullPolicy: Always
      pullPolicy: IfNotPresent

  route:
    enabled: true
    host: as-packetdelivery.dsba.fiware.dev
    tls:
      termination: edge
      insecureEdgeTerminationPolicy: Redirect
    certificate:
      issuer: 
        kind: ClusterIssuer
        name: letsencrypt-aws-prod

  # Use values from existing secret as ENVs
  existingSecretEnvs: pdc-as-envs-secret
        
  ## Configuration of activation service execution
  activationService:
    # -- Listen port
    port: 8080
    # -- Number of (gunicorn) workers that should be created
    workers: 1
    # -- Maximum header size in bytes
    maxHeaderSize: 32768
    # -- Log Level
    logLevel: "debug"

  ccs:
    endpoint: "http://dsba-packet-delivery-ccs-credentials-config-service:8080/"
    id: "pdc-activation-service"
    credentials:
      - type: "VerifiableCredential"
        trustedParticipantsLists: [
          "https://tir.dsba.fiware.dev"
        ]
        trustedIssuersLists: [
          "http://dsba-packet-delivery-til-trusted-issuers-list:8080"
        ]
      - type: "ActivationService"
        trustedParticipantsLists: [
          "https://tir.dsba.fiware.dev"
        ]
        trustedIssuersLists: [
          "http://dsba-packet-delivery-til-trusted-issuers-list:8080"
        ]
    
  config:
    db:
      # -- Use sqlite in-memory database
      useMemory: true
      # -- Enable tracking of modifications
      modTracking: false
      # -- Enable SQL logging to stderr
      echo: true

    # Configuration for additional API keys to protect certain endpoints
    apikeys:
      # Config for iSHARE flow
      ishare:
        # Enable for /token endpoint (API key will be required)
        enabledToken: false
        # Enable for /createpolicy endpoint (API key will be required)
        enabledCreatePolicy: false
      # Config for Trusted-Issuers-List flow
      issuer:
        # Header name
        headerName: "AS-API-KEY"
        # API key (auto-generated if left empty)
        apiKey: ""
        # Enable for /issuer endpoint (API key will be required)
        enabledIssuer: true
      
    ar:
      # Endpoint for token request
      token: "https://ar.isharetest.net/connect/token"
      # Endpoint for create policy requests
      policy: "https://ar.isharetest.net/policy"
      # Endpoint for delegation requests
      delegation: "https://ar.isharetest.net/delegation"
      # EORI of AR
      id: "EU.EORI.DEPROVIDER"

    issuer:
      clientId: "pdc-activation-service"
      providerId: "did:web:packetdelivery.dsba.fiware.dev:did"
      tilUri: "http://dsba-packet-delivery-til-trusted-issuers-list:8080"
      verifierUri: "https://verifier-pdc.dsba.fiware.dev"
      samedevicePath: "/api/v1/samedevice"
      jwksPath: "/.well-known/jwks"
      algorithms:
        - "ES256"
      roles:
        createRole: "CREATE_ISSUER"
        updateRole: "UPDATE_ISSUER"
        deleteRole: "DELETE_ISSUER"
